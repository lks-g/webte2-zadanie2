<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Test API</title>
</head>

<body>
    <nav class="navbar navbar-expand-md bg-dark navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="../index.php">Lunch Menus</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../php/api_doc.php">API</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../php/validate.php">Validate API</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Test API</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-5">
        <div class="row">
            <div class="col-lg-8">
                <h1 class="mb-4">Lunch Menu</h1>
                <div id="lunch-menu"></div>
            </div>
            <div class="col-lg-4">
                <h2 class="mb-4">Add an item to the menu:</h2>
                <form>
                    <div class="form-group">
                        <label for="item-name">Name</label>
                        <input type="text" class="form-control" id="item-name" name="item-name" required>
                    </div>
                    <div class="form-group">
                        <label for="item-price">Price</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">$</span>
                            </div>
                            <input type="number" class="form-control" id="item-price" name="item-price" step="0.01" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Add Item</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
    <script>
        const form = document.querySelector('form');

        form.addEventListener('submit', (event) => {
            event.preventDefault();
            const itemName = document.querySelector('#item-name').value;
            const itemPrice = document.querySelector('#item-price').value;

            axios.post('/api/addMenuItem', {
                name: itemName,
                price: itemPrice
            })
                .then(response => {
                    console.log(response);
                    getMenu();
                })
                .catch(error => {
                    console.error(error);
                });
        });

        function getMenu() {
            axios.get('/api/menu')
                .then(response => {
                    const menuItems = response.data;

                    let menuHtml = '<ul>';
                    menuItems.forEach(item => {
                        menuHtml += `<li>${item.name} - ${item.price}</li>`;
                    });
                    menuHtml += '</ul>';

                    document.querySelector('#lunch-menu').innerHTML = menuHtml;
                })
                .catch(error => {
                    console.error(error);
                });
        }
        getMenu();
    </script>
</body>

</html>